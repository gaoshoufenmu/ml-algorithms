预测算法

近似算法

每个时刻选出当前最有可能的状态。缺点：没有基于全局考虑。

给定马尔可夫模型参数$$\lambda$$ 和观测序列$$O$$，在时刻$$t$$ 处于状态$$i$$ 的概率为，

$$\gamma_t(i) =P(i_t=i,O|\lambda) / P(O|\lambda)$$

于是时刻$$t$$ 的最有可能的状态为

$$i_t = \text{argmax}_{1\le i \le N} \ \gamma_t(i), \quad \forall t \in [n]$$

比较简单，不再啰嗦。

维特比算法

使用了动态规划求概率最大路径得到状态序列。

对于长度为$$n$$ 的观测序列，每个观测的可能状态数为$$N$$，那么所有路径的数目为$$N^n$$ 个，如果分别计算这些路径的概率，然后再比较根据概率最大来选择最优路径，显然效率不高。

注意到所有可能的路径中，其实有一些路径，根本没必要去计算其完整路径的概率，而是在计算中途就可以将其过滤掉，如下图，

![](/assets/predicator_1.png)

为了方便描述概率，我们引入$$t$$ 时刻状态为$$i$$ 的$$[0,t]$$ 前缀序列的最大完全概率

$$\delta_t(i) = \text{max}_{i_1,...,i_{t-1}}P(i_t = i, i_{t-1},...,i_1, o_t,...,o_1|\lambda)$$                                                                          \(1\)

于是要得到最优路径，只要计算

$$i_T = \text{argmax}_{1 \le i \le N} \ \delta_T(i)$$                                                                                                                                 \(2\)

就得到最佳路径中$$T$$  时刻的状态。

根据\(1\)式，显然有$$t=1$$时，

$$\delta_1(i) = \pi_i b_{io_1}$$                                                                                                                                                       \(3\)

要求出\(2\)，根据\(3\)再结合迭代公式，就不难了，而迭代公式为，

$$\begin{aligned} \delta_{t+1}(i) & = \text{max}_{i_1,...,i_t} \ P(i_{t+1}=i, i_t,...,i_1,o_{t+1},o_t,...,o_1|\lambda) \\ & = \text{max}_{i_1,...,i_t} \ P(i_t,...,i_1,o_t,...,o_1|\lambda) a_{i_ti}b_{io_{t+1}} \\ & = \text{max}_{i_t} \text{max}_{i_1,...,i_{t-1}} \ P(i_t = i_t, i_{t-1},...,i_1, o_t,...,o_1|\lambda)a_{i_ti}b_{io_{t+1}} \\ & = \text{max}_{i_t} [\delta_t(i_t)a_{i_ti}]b_{io_{t+1}} \end{aligned} $$                                        \(4\)



